- pipeline: "Build"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "refs/tags/*"
  ref_type: "WILDCARD"
  trigger_condition: "ALWAYS"
  actions:
    - action: "Execute: git push origin --tags"
      type: "BUILD"
      working_directory: "/buddy/fe7-jp-stunning-tribble"
      docker_image_name: "devkitpro/devkitarm"
      docker_image_tag: "latest"
      execute_commands:
        - "if [ ! -d \"cmake-3.16.4-Linux-x86_64\" ]; then wget https://github.com/Kitware/CMake/releases/download/v3.16.4/cmake-3.16.4-Linux-x86_64.tar.gz; tar -zxvf cmake-3.16.4-Linux-x86_64.tar.gz; fi"
        - "PATH=`pwd`/cmake-3.16.4-Linux-x86_64/bin:$PATH ./configure"
        - "cd build && make"
        - "xdelta3 -S djw -s ../rom/fe7-jp.gba fe7-jp-stunning-tribble.gba fe7-jp-stunning-tribble.xd"
      setup_commands:
        - "apt-get update && apt-get -y install xdelta3"
      mount_filesystem_path: "/buddy/fe7-jp-stunning-tribble"
      shell: "BASH"
      trigger_condition: "ALWAYS"
