#include "event_handler.h"

#include <gba_types.h>
#include <gba_video.h>

//#include "BG001_BraveForest.h"
/*
const struct Background backgrounds[] = {
    {BG001_BraveForestTiles, BG001_BraveForestPal}, // 0
};

void LoadBackgroundNew(u16 backgroundId)
{
    func800ec08();
    SetBgPosition(0, 0, 0);
    SetBgPosition(1, 0, 0);
    SetBgPosition(2, 0, 0);
    SetBgPosition(3, 0, 0);
    writeTiles(backgrounds[backgroundId].tiles, BGTiles);
    for(int i = 0; i < 256 * 160 / 2; i++)
        BGTiles[i] |= 0x8080;
    writeTSAPlain(BG2MapBuffer, 160, 160 / 8, 256 / 8);
    setBGMapBufferSyncFlag(1 << 2);
    writeBGPalette(backgrounds[backgroundId].palette, 32 * 8, 32 * 8);
    BGPaletteBuffer[0] = 0; // Set background color
    REG_DISPCNT_BUFFER = MODE_1 | BG0_ON | BG1_ON | BG2_ON | OBJ_ON;
    REG_BG2CNT_BUFFER |= BG_256_COLOR | BG_SIZE_1;
    REG_BG2X_BUFFER = 0;
    REG_BG2Y_BUFFER = 0;
    REG_BG2PA_BUFFER = 0;
    REG_BG2PB_BUFFER = 0;
    REG_BG2PC_BUFFER = 0;
    REG_BG2PD_BUFFER = 0;
}

// load BG with 128 colors
int EvtCmdHandler_LoadBackgroundNew(struct Proc *proc)
{
    u16 backgroundId = *(u16 *)(*(int *)(proc->data + 7) + 2);

    if((*(u16 *)(proc->data + 0x35) & 4) == 0)
    {
        if(proc->data[0x23] == 0xff)
        {
            LockGameGraphicsLogic();
            func806d51c();
        }

        LoadBackgroundNew(backgroundId);
        proc->data[0x23] = backgroundId;
        return 2;
    }

    return 0;
}

void ClearBackgroundNew()
{
    REG_DISPCNT_BUFFER = MODE_0 | BG0_ON | BG1_ON | BG2_ON | BG3_ON | OBJ_ON;
    REG_BG2CNT_BUFFER &= ~(BG_256_COLOR | BG_SIZE_1);
}

int EvtCmdHandler_ClearBackgroundNew(struct Proc *proc)
{
    ClearBackgroundNew();

    return 0;
}
*/
const struct EvtCmdHandler EvtCmdHandlers[] = {
    {134277965, 1} ,  // 0
    {134278065, 1} ,  // 1
    {134263813, 1} ,  // 
    {134263861, 1} ,  // 
    {134263909, 1} ,  // 
    {134263957, 1} ,  // 
    {134264185, 1} ,  // 
    {134264237, 1} ,  // 
    {134264053, 1} ,  // 
    {134264305, 1} ,  // 
    {134264381, 1} ,  // 
    {134264441, 1} ,  // 
    {134264589, 1} ,  // 
    {134265037, 2} ,  // 
    {134265089, 2} ,  // 
    {134265149, 3} ,  // 
    {134265237, 2} ,  // 
    {134265273, 2} ,  // 
    {134265321, 3} ,  // 
    {134265397, 1} ,  // 
    {134265437, 1} ,  // 
    {134265485, 2} ,  // 
    {134265557, 2} ,  // 
    {134265701, 3} ,  // 
    {134265777, 3} ,  // 
    {134265849, 4} ,  // 
    {134265929, 4} ,  // 
    {134266009, 4} ,  // 
    {134266085, 1} ,  // 
    {134266365, 1} ,  // 
    {134266477, 1} ,  // 
    {134266605, 1} ,  // 
    {134266245, 1} ,  // 
    {134266729, 3} ,  // 
    {134266989, 4} ,  // 
    {134267901, 3} ,  // 
    {134267245, 3} ,  // 
    {134267413, 4} ,  // 
    {134267765, 3} ,  // 
    {134268097, 3} ,  // 
    {134268237, 2} ,  // 
    {134268405, 4} ,  // 
    {134268685, 4} ,  // 
    {134267589, 3} ,  // 
    {134268877, 3} ,  // 
    {134269033, 3} ,  // 
    {134269117, 3} ,  // 
    {134269229, 3} ,  // 
    {134270069, 2} ,  // 
    {134270137, 2} ,  // 
    {134270205, 3} ,  // 
    {134270413, 5} ,  // 
    {134270313, 2} ,  // 
    {134270353, 3} ,  // 
    {134270549, 5} ,  // 
    {134271337, 3} ,  // 
    {134292973, 2} ,  // 
    {134271533, 1} ,  // 
    {134271593, 1} ,  // 
    {134271609, 1} ,  // 
    {134271629, 2} ,  // 
    {134271665, 2} ,  // 
    {134271717, 2} ,  // 
    {134271773, 2} ,  // 
    {134271821, 2} ,  // 
    {134271869, 1} ,  // 
    {134271873, 2} ,  // 
    {134271969, 2} ,  // 
    {134271985, 3} ,  // 
    {134272053, 3} ,  // 
    {134272121, 3} ,  // 
    {134272161, 3} ,  // 
    {134272201, 2} ,  // 
    {134272237, 2} ,  // 
    {134272273, 3} ,  // 
    {134272381, 3} ,  // 
    {134272489, 3} ,  // 
    {134272633, 2} ,  // 
    {134272669, 2} ,  // 
    {134272705, 2} ,  // 
    {134272773, 2} ,  // 
    {134272805, 2} ,  // 
    {134272837, 2} ,  // 
    {134272885, 4} ,  // 
    {134272973, 2} ,  // 
    {134273009, 3} ,  // 
    {134273065, 2} ,  // 
    {134273077, 2} ,  // 
    {134273113, 2} ,  // 
    {134273149, 2} ,  // 
    {134273173, 3} ,  // 
    {134273213, 2} ,  // 
    {134277121, 2} ,  // 
    {134273277, 1} ,  // 
    {134273817, 1} ,  // 
    {134273637, 1} ,  // 
    {134273693, 1} ,  // 
    {134273781, 1} ,  // 
    {134273429, 1} ,  // 
    {134273933, 3} ,  // 
    {134274005, 2} ,  // 
    {134274117, 2} ,  // 
    {134274313, 2} ,  // 
    {134274449, 1} ,  // 
    {134274517, 2} ,  // 
    {134274653, 2} ,  // 
    {134274713, 2} ,  // 
    {134274917, 2} ,  // 
    {134275085, 2} ,  // 
    {134275193, 2} ,  // 
    {134275225, 2} ,  // 
    {134275253, 2} ,  // 
    {134275281, 3} ,  // 
    {134275321, 3} ,  // 
    {134275425, 3} ,  // 
    {134275525, 3} ,  // 
    {134275645, 1} ,  // 
    {134275661, 1} ,  // 
    {134275677, 1} ,  // 
    {134275885, 1} ,  // 
    {134275933, 1} ,  // 
    {134275949, 2} ,  // 
    {134275985, 1} ,  // 
    {134276021, 1} ,  // 
    {134276061, 1} ,  // 
    {134276109, 1} ,  // 
    {134275717, 2} ,  // 
    {134276173, 1} ,  // 
    {134276241, 1} ,  // 
    {134276265, 1} ,  // 
    {134276289, 4} ,  // 
    {134276369, 1} ,  // 
    {134276465, 1} ,  // 
    {134276505, 1} ,  // 
    {134276545, 1} ,  // 
    {134276589, 1} ,  // 
    {134276621, 1} ,  // 
    {134276649, 1} ,  // 
    {134276701, 1} ,  // 
    {134276761, 1} ,  // 
    {134276821, 1} ,  // 
    {134276857, 1} ,  // 
    {134276945, 1} ,  // 
    {134276981, 1} ,  // 
    {134277017, 1} ,  // 
    {134277029, 1} ,  // 
    {134276893, 1} ,  // 
    {134277041, 4} ,  // 
    {134277081, 4} ,  // 
    {134277205, 5} ,  // 
    {134277721, 1} ,  // 
    {134277737, 2} ,  // 
    {134277749, 1} ,  // 
    {134277757, 1} ,  // 
    {134277789, 1} ,  // 
    {134277861, 1} ,  // 
    {134277901, 1} ,  // 
    {134277917, 4} ,  // 
    {134277949, 2} ,  // 
    {134281845, 2} ,  // 
    {134281861, 2} ,  // 
    {134281877, 1} ,  // 
    {134281889, 2} ,  // 
    {134281913, 2} ,  // 
    {134281957, 2} ,  // 
    {134281981, 3} ,  // 
    {134282149, 4} ,  // 
    {134282305, 1} ,  // 
    {134282333, 1} ,  // 
    {134282349, 2} ,  // 
    {134282429, 3} ,  // 
    {134282501, 3} ,  // 
    {134282617, 3} ,  // 
    {134279801, 4} ,  // 
    {134279905, 1} ,  // 
    {134279973, 1} ,  // 
    {134279985, 2} ,  // 
    {134280069, 1} ,  // 
    {134280301, 5} ,  // 
    {134280385, 4} ,  // 
    {134280489, 2} ,  // 
    {134280553, 1} ,  // 
    {134280585, 1} ,  // 
    {134280617, 1} ,  // 
    {134280645, 5} ,  // 
    {134280765, 3} ,  // 
    {134280829, 4} ,  // 
    {134280901, 3} ,  // 
    {134280977, 1} ,  // 
    {134281013, 2} ,  // 
    {134281405, 5} ,  // 
    {134281533, 2} ,  // 
    {134281565, 5} ,  // 
    {134281693, 2} ,  // 
    {134281725, 4} ,  // 
    {134281041, 3} ,  // 
    {134281105, 3} ,  // 
    {134281169, 3} ,  // 
    {134281233, 3} ,  // 
    {134281297, 4} ,  // 
    {134281381, 1} ,  // 
    {134280097, 4} ,  // 
    {134280185, 2} ,  // 
    {134280269, 1} ,  // 
    {134282693, 2} ,  // 
    {134282713, 3} ,  // 
    {134282849, 3} ,  // 
    {134282953, 3} ,  // 
    {134283421, 2} ,  // 
    {134284049, 2} ,  // 
    {134284293, 3} ,  // 
    {134284353, 4} ,  // 
    {134284417, 3} ,  // 
    {134284473, 1} ,  // 
    {134284501, 1} ,  // 
    {134284609, 1} ,  // 
    {134284625, 1} ,  // 
    {134284713, 1} ,  // 
    {134286325, 3} ,  // 
    {134286429, 1} ,  // 
    {134287893, 3} ,  // 
    {134287945, 3} ,  // 
    {134288649, 2} ,  // 
    {134289325, 2} ,  // 
    {134289861, 1} ,  // 
    {134289901, 1} ,  // 
    {134290173, 3} ,  // 
    {134291565, 5} ,  // 
    {134291137, 3} ,  // 
    {134291877, 4} ,  // 
    {134291953, 1} ,  // 
    {134291965, 1} ,  // 
    {134292189, 3} ,  // 
    {134292285, 1} ,  // 
    {134292345, 4} ,  // 
    {134292413, 1} ,  // 
    //{EvtCmdHandler_LoadBackgroundNew, 1}, // 0xEC
    //{EvtCmdHandler_ClearBackgroundNew, 1}, // 0xED
};

const struct EvtCmdHandler * const pEvtCmdHandlers1 = EvtCmdHandlers;
const struct EvtCmdHandler * const pEvtCmdHandlers2 = EvtCmdHandlers;
const struct EvtCmdHandler * const pEvtCmdHandlers3 = EvtCmdHandlers;
const struct EvtCmdHandler * const pEvtCmdHandlers4 = EvtCmdHandlers;
